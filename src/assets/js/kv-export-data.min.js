/*!
 * @package   yii2-export
 * @author    Kartik Visweswaran <kartikv2@gmail.com>
 * @copyright Copyright &copy; Kartik Visweswaran, Krajee.com, 2015 - 2018
 * @version   1.3.0
 *
 * Export Data Validation Module.
 *
 * Author: Kartik Visweswaran
 * Copyright: 2015, Kartik Visweswaran, Krajee.com
 * For more JQuery plugins visit http://plugins.krajee.com
 * For more Yii related demos visit http://demos.krajee.com
 */!function(a){"use strict";var b=function(b,c){return null===b||void 0===b||b===[]||""===b||c&&""===a.trim(b)},c=function(a,b,c,d){var e=screen.width/2-c/2,f=60,g=window.open("",b,"",!0);return g.close(),window.open(a,b,"toolbar=no, location=no, directories=no, status=yes, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+c+", height="+d+", top="+f+", left="+e)},d='<html style="display:table;width:100%;height:100%;"><title>Export Data - &copy; Krajee</title><body style="display:table-cell;font-family:Helvetica,Arial,sans-serif;color:#888;font-weight:bold;line-height:1.4em;text-align:center;vertical-align:middle;width:100%;height:100%;padding:0 10px;">{msg}</body></html>',e=function(b,c){var d=this;d.$element=a(b),a.each(c,function(a,b){d[a]=b});var e=c.settings;d.$form=a("#"+e.formId),d.messages=e.messages,d.popup="",d.listen()};e.prototype={constructor:e,setPopupAlert:function(a){var b=this;if(b.popup.document)if(arguments.length&&arguments[1]){var c=b.popup.document.getElementsByTagName("body");setTimeout(function(){c[0].innerHTML=a},4e3)}else{var e=d.replace("{msg}",a);b.popup.document.write(e)}},listen:function(){var a=this;a.$form.attr("action",window.location.href).appendTo("body"),a.listenClick(),"_popup"===a.target&&a.$form.off("submit.exportmenu").on("submit.exportmenu",function(){setTimeout(function(){a.setPopupAlert(a.messages.downloadComplete,!0)},1e3)})},processExport:function(d){var f,e=this,g=[];e.$form.find('[name="export_type"]').val(d),"_popup"===e.target&&(e.popup=c("","kvExportFullDialog",350,120),e.popup.focus(),e.setPopupAlert(e.messages.downloadProgress)),b(e.columnSelectorId)||(f=a("#"+e.columnSelectorId).parent().find('input[name="export_columns_selector[]"]'),f.each(function(){var b=a(this);b.is(":checked")&&g.push(b.attr("data-key"))}),e.$form.find('input[name="export_columns"]').val(JSON.stringify(g))),e.$form.trigger("submit")},listenClick:function(){var c=this;c.$element.off("click.exportmenu").on("click.exportmenu",function(d){var e,f,h,i,j,g="",k=window[c.dialogLib];return e=a(this).data("format"),d.preventDefault(),d.stopPropagation(),c.showConfirmAlert?(f=c.messages,h=b(c.alertMsg)?"":c.alertMsg,i=b(f.allowPopups)?"":f.allowPopups,j=b(f.confirmDownload)?"":f.confirmDownload,g=h.length&&i.length?h+"\n\n"+i:!h.length&&i.length?i:h.length&&!i.length?h:"",j.length&&(g=g+"\n\n"+j),b(g)?void c.processExport(e):void k.confirm(g,function(a){a&&c.processExport(e)})):void c.processExport(e)})}},a.fn.exportdata=function(b){var c=Array.apply(null,arguments);return c.shift(),this.each(function(){var d=a(this),f=d.data("exportdata"),g="object"==typeof b&&b;f||d.data("exportdata",f=new e(this,a.extend({},a.fn.exportdata.defaults,g,a(this).data()))),"string"==typeof b&&f[b].apply(f,c)})},a.fn.exportdata.defaults={filename:"export",target:"_popup",showConfirmAlert:!0,columnSelectorId:null,alertMsg:"",dialogLib:"krajeeDialog",settings:{formId:"",messages:{allowPopups:"",confirmDownload:"",downloadProgress:"",downloadComplete:""}}}}(window.jQuery);